# Проектирование высоконагруженных систем
## 1. Тема и целевая аудитория
### Тема: X

Информация о сервисе и нагрузке:
- DAU 217 миллионов пользователей. (в лекции было 436, взято из [2](https://www.meltwater.com/en/blog/twitter-stats-marketers-need-to-know))

| Гендер  | Процент (%) |
| --- | ------ |
| Мужчина | 56 |
| Женщина | 44 |



| Возраст (лет) | Процент пользователей (%) |
| --- | ------ |
| 13-17 |  6.6   |
| 18-24 |  17.1   |
| 25-34 |  38.5  |
| 35-49 |  20.7   |
| 50+  | 17.1   |

MVP функционал:
- Регистрация
- Аккаунт: профиль, информация о профиле
- Фото и видео для профиля
- твиты, фото и видео в твитах, репосты твитов
- комментарии к твитам и комментарии к комментариям(в виде дерева)
- рекомендательная система твитов
- Настройки профиля
- Поиск: поиск по хэштегам
- Уведомления

Ключевой функционал - посты и поиск по ним, переписка между пользователями.
Ключевые продуктовые решения:
- хэштеги: для поиска и группировки твитов по темам
- ретвиты

## 2. Расчет нагрузки

### Продуктовые метрики

| метрика | значение |
| --- | ------ |
| MAU |  550MM |
| DAU |  217MM |

| память на 1 | значение |
| --- | ------ |
| твит |  300 байт |
| фото | 16 кбайт |
| видео | 1 мбайт |


| действия пользователя (среднее) | значение | память |
| ---  | ---- |  --- |
| чтение твитов | 500 | - |
| лайк (твита и комментария) | 70 | 8 байт |
| поиск твита | 200 | - |
| написание комментария | 10 | 100 байт |
| написания твита | 10 | (расчитано ниже) |
| репост твита | 5 | - |

возьмём, что каждый 3 твит с видео, и в каждом твите в среднем есть 2 фотографии.

32 КБ + 200 Байт = 32.2 КБ (твит с 2 фото)
200 байт + 1 МБ = 1.0002 МБ ~ 1 Мб(твит с видео)
100 байт * 10 = 1000 байт ~ 1КБ (комментарии)

Средний размер хранилища пользователя -  3.644 мбайт - пользователь/ сутки

### Технические метрики

хранения в разбивке по типам данных

| Данные | Кол-во в сутки | память в сутки (ГБ) |
| ---   |  -- |  ---         |
| твиты | 2.17 B | 404       |
| фото | 4.34 B | 66223      |
| видео | 0.724 B | 707031   |
| комментарии | 2.7 B | 2574 |

| Сетевой трафик | среднее потребление | пиковое потребление |
| --- | ---- | --- |
| твиты | 0.004676  ГБ/c |  0.004676 ГБ/c  | 
| фото |  0.76647 ГБ/c   |  1.916175 ГБ/c  |
| видео | 8.18323 ГБ/c   |  20.458075 ГБ/c |

Суммарный суточный  трафик - 773658 ГБ/cутки

| RPS | средний | пик |
| ---  | ---- | --- |
| получение твита | 1255787  | 3139467 |
| лайк твита | 175810  | 439525 |
| поиск твита | 502314  | 1255785 |
| написание комментария | 25115  | 62789 |
| написания твита | 25115 | 62787  | 
| репост твита | 12557  | 31393  |
| проверка авторизации + авторизация | 2046698 | 5116745 |


### Список источников:
1. [X](https://x.com/ "сам твиттер")
2. [Statista](https://www.statista.com/statistics/242606/number-of-active-twitter-users-in-selected-countries/)
3. [Tridenstechnology](https://tridenstechnology.com/ru/c%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9-twitter/)
4. [MeltWater](https://www.meltwater.com/en/blog/twitter-stats-marketers-need-to-know)
5. [wifitalents](https://wifitalents.com/statistic/twitter/ "немного отличается от предыдущих статистик")
